---
title: "Horror Movie Visualizations"
subtitle: "STA/ISS 313 - Spring 2023 - Project 1"
author: "Viz Villains- Christopher Tsai, Chris Liang, Jason Zhang, Kevin Ordet"
format: html
editor: visual
---

## Abstract

This project takes data extracted from [The Movie Database](https://www.themoviedb.org) via tmdb API using R `httr`. The purpose of this project is to analyze a) how trends in factors surrounding horror as a genre (e.g. popularity, budgets, etc) have changed over time and b) how different subgenres are associated with popularity of horror films as a whole. This project aims to create compelling visualizations to analyze the two research questions above and deliver findings that can be useful in determining next steps for analysis.

------------------------------------------------------------------------

## Introduction

(1-2 paragraphs): Brief introduction to the dataset. You may repeat some of the information about the dataset provided in the introduction to the dataset on the TidyTuesday repository, paraphrasing on your own terms. Imagine that your project is a standalone document and the grader has no prior knowledge of the dataset.

## Question 1: Title that relates to the question you're answering

### Introduction

In this question we wanted to look at how the popularity of movies changed over the years 1980 to 2022. The first thing we had to do was figure out to measure popularity over time. We decided that measuring how many movies were released in that given year for the theater (which equated to having a budget of over \$2,000,000 in 2022 dollars) would be a good estimator of the popularity of horror movies in a given year. We also decided to look at the popularity of both English and Foreign language horror films to see if there was a difference in the popularity trends of those.

To make this plot we also needed to use the budget and profit data given in the dataset. However, this data was given in the dollar value of the year that the movie was released. In order to scale these amounts to make them comparable, we found a data set that showed how much one dollar in 1950 was worth in that given year. We figured it would make more sense to the audience to have each dollar amount interpreted in terms of 2022 dollars so we reversed the scale to make each dollar amount in budget and profit be in terms of 2022 dollars. We were interested in this question because given the limitations of our data it was one of the only things that might show an interesting trend and we were also interested in how the climate/environment (political, recent big horror movies, etc.) may effect the number of films released in a given year.

### Approach

(1-2 paragraphs): Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

To answer this question we will make 2 line plots using geom_line() and will use geom_smooth() to create a trend line that shows us the short-term trends in the data. We will also be making a scatter plot using geom_point() to look at individual observations of the data.

We first made a scatter plot where each point corresponded to the total number of horror movies made for theatrical release in each year. Because we wanted to look at individual observations (ie. the year 2009 and how many movies were made then) a scatter plot and then circling the observations we wanted to note would be the best way to do so. We then made a line plot using geom_line() and the used geom_smooth() to add a trend line. This plot wanted to initially look at the general trend of movie popularity over time and then relate it to the socioeconomic/political status of the United States at the time. Using geom_smooth() to create a trend line would easily allow us to see the direct impact of certain events on the popularity of horror movies while also allowing us to see when horror movies truly began to increase in popularity, decrease in popularity, and max out in popularity.

### Analysis

```{r}
#| label: scatterplot-popularity-graph
description1 <-
  "Horror Movies saw their popularity peak in 2010. Insidious and Paranormal Activity, both released in 2010 saw the highest dollars of profit per dollars of budget of all Horror Movies between 1980 and 2022." |>
  str_wrap(width = 40) #description for annotate

description2 <-
  "7 of the 16 Horror Movies with the biggest profit were released in 1999 or 2000 marking the catalyzation of a decade long growth in the popularity of Horror Movies" |>
  str_wrap(width = 40)

description3 <-
  "Number of Horror Movies released in 2020 drastically decreases, likely due to COVID-19. The ability to make movies and the number of possible audience members decreased." |>
  str_wrap(width = 40)

plot_circle_purple <- horror_new |>
  group_by(release_year) |>
  summarise(count = n()) |>
  filter(release_year == 2009 |
           release_year == 2010) #create dataset for circles around plot points of note

plot_circle_blue <- horror_new |>
  group_by(release_year) |>
  summarise(count = n()) |>
  filter(release_year == 1999 | release_year == 2000)

plot_circle_black <- horror_new |>
  group_by(release_year) |>
  summarise(count = n()) |>
  filter(release_year == 2019 | release_year == 2020)

horror_new |>
  group_by(release_year) |>
  summarise(count = n()) |>
  ggplot(aes(x = release_year, y = count)) +
  geom_point(size = 3) +
  geom_point(
    data = plot_circle_purple,
    pch = 21,
    size = 8,
    colour = "purple"
  ) +
  geom_point(
    data = plot_circle_blue,
    pch = 21,
    size = 8,
    colour = "deepskyblue4"
  ) +
  geom_point(
    data = plot_circle_black,
    pch = 21,
    size = 8,
    colour = "black"
  ) + #adds circle around plot points of note
  annotate(
    "label",
    x = 2000,
    y = 67,
    label = description1,
    alpha = 0.6,
    size = 5,
    color = "purple"
  ) + #adds the annotation with the text in the same color as the annotation of note
  annotate(
    "label",
    x = 1995,
    y = 40,
    label = description2,
    alpha = 0.6,
    size = 5,
    color = "deepskyblue4"
  ) +
  geom_ellipse(aes(
    x0 = 2019.6,
    y0 = 30.7,
    a = 11.3,
    b = 1,
    angle =  -1.45 * pi / 3
  ),
  color = "black") + #draws an ellipse around the 2019 and 2020 points
  annotate(
    "label",
    x = 2012,
    y = 20,
    label = description3,
    alpha = 0.8,
    size = 5
  ) +
  labs(
    title = "How the number of horror movies launched for theatrical release changed over time",
    subtitle = "From 1980-2020",
    x = "Year",
    y = "Number of Horror Movies",
    color = "Language"
  ) +
  theme(
    legend.key.size = unit(3, 'cm'),
    #change legend key size
    legend.key.height = unit(3, 'cm'),
    #change legend key height
    legend.key.width = unit(3, 'cm'),
    #change legend key width
    plot.title = element_text(size = 18),
    #increases size of plot title
    plot.subtitle = element_text(size = 18),
    axis.title = element_text(size = 14)
  ) +
  scale_color_discrete(labels = c('English', 'Other')) #changes the names on the legends
```

```{r}
#| label: lineplot-popularity-graph
description1 <-
  "9/11- Terrorist crash a plane into the World Trade Center. Questions about American security arise" |>
  str_wrap(width = 40) #description to put in annotation

description2 <-
  "The stock market crashes in 2009. Questions about American economic security arise." |>
  str_wrap(width = 40)

horror_new |>
  mutate(en_language = ifelse(original_language == "en", "en", "non-en")) |>
  group_by(release_year, en_language) |>
  summarise(count = n()) |>
  ggplot(aes(x = release_year, y = count, color = en_language)) + #adds different line plot based on the language the movie was in
  geom_point(alpha = 0.3) +
  geom_line(alpha = 0.3) +
  geom_smooth(se = FALSE) +
  geom_segment(
    x = 2001,
    xend = 2001,
    y = -5,
    yend = 27,
    col = "black",
    linewidth = 1.5
  ) + #adds vertical line at 2001
  geom_segment(
    x = 2009,
    xend = 2009,
    y = -5,
    yend = 45,
    col = "black",
    linewidth = 1.5
  ) +
  annotate(
    "label",
    x = 1995,
    y = 35,
    label = description1,
    alpha = 0.6,
    size = 5
  ) +
  annotate(
    "label",
    x = 2015.5,
    y = 51,
    label = description2,
    alpha = 0.6,
    size = 5
  ) +
  labs(
    title = "Uncertainty and Anxiety- How Horror Flicks Popularity Correlates with a Need for an Outlet of Fears",
    x = "Year",
    y = "Total Number of Movies for Theatrical Release",
    color = "Language"
  ) +
  theme(
    legend.key.size = unit(3, 'cm'),
    legend.key.height = unit(3, 'cm'),
    legend.key.width = unit(3, 'cm'),
    plot.title = element_text(size = 18),
    axis.title = element_text(size = 14)
  ) +
  scale_color_discrete(labels = c('English', 'Other'))
```

### Discussion

(1-3 paragraphs): In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots. Speculate about why the data looks the way it does.

The first thing we noticed with our plot was a peak in the number of horror movies released for theater in the range of 2008 - 2010. We wanted to try to understand if this was an anomaly or these years were truly the most popular years for horror movies. We ended up creating a new variable that looked at the dollars of profit for the movie per one dollar put into the budget and saw that the two movies with the highest ratio of profit to budget were made in 2010 confirming our suspicion that 2008 - 2010 were the most popular years for horror movies. We also noticed that in the range of 1999 - 2001 the number of horror movies released for theater began to drastically increase. Again, we noticed that the 7 of the 16 movies with the largest profit (in 2022 dollars) were released in this year. It is likely that movie directors and production companies noticed this potential for profit and began to release more horror movies. Finally, we noticed that there was a sharp decrease in the number of horror movies released from 2019 to 2020. We thought that this was likely a result of the Coronavirus and the inability for production companies to film movies and the lack of an audience to make movies for.

We then wanted to delve into the socioeconomic/political state of the US and how that potentially impacted the popularity of horror movies. Originally we had wanted to look at international films as well, but the small amount of them prevented us from being certain about the trend of their popularity. The graph showed that the amount of horror movies released began to increase in around 1996, before seeing the most drastic increase happen in 2001 and 2002. We then noticed that the number of horror movies peaked out in 2009 and 2010. We again wanted to see if there were any events happening in these years that may have affected the socioeconomic/political state of the US and there were. In 2001, terrorists from Al-Qaeda crashed a plane into the World Trade Centers causing uncertainty and panic about American national security. In 2009, the stock market crashed causing concerns and anxiety about American economic security. We then hypothesized that the popularity of horror movies drastically increased and peaked out in these years because horror movies serve as an outlet for human fears and in these times of mass uncertainty and fear horror movies are needed. Following that idea, we would expect horror movies to increase in number in the upcoming years following the uncertainty and panic caused by the Coronavirus.

## Question 2: Title that relates to the question you're answering

### Introduction

(1-2 paragraphs): Introduction to the question and what parts of the dataset are necessary to answer the question. Also discuss why you're interested in this question.

### Approach

(1-2 paragraphs): Describe what types of plots you are going to make to address your question. For each plot, provide a clear explanation as to why this plot (e.g. boxplot, barplot, histogram, etc.) is best for providing the information you are asking about. The two plots should be of different types, and at least one of the two plots needs to use either color mapping or facets.

### Analysis

(2-3 code blocks, 2 figures, text/code comments as needed): In this section, provide the code that generates your plots. Use scale functions to provide nice axis labels and guides. You are welcome to use theme functions to customize the appearance of your plot, but you are not required to do so. All plots must be made with **ggplot2**. Do not use base R or lattice plotting functions.

### Discussion

(1-3 paragraphs): In the Discussion section, interpret the results of your analysis. Identify any trends revealed (or not revealed) by the plots. Speculate about why the data looks the way it does.
